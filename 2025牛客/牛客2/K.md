#### 题意：

给定一个长度为n的01字符串

若一个字符串存在不相交的一段前缀和一段后缀完全一致，且两者间隔字符不超过k个，则是好串。

q次询问，问字典序排第x的好子字符串是什么？

n~1e4 ， q~5e5

#### 解：

![image-20250719163411899](C:/Users/Henson/AppData/Roaming/Typora/typora-user-images/image-20250719163411899.png)

先通过上图的方式预处理，然后遍历每一个前缀开头位置i和后缀开头位置j，O1求出他们的到末尾的公共前缀，于是可以确定一个范围：子字符串开头在i，结尾在该范围的都是好串。可以用一个类似差分的方法维护每一个j的结果，而后对于同一个i，前缀一下，插入字典树中。

查询时，查询字典树，考察当前位置的字符串个数是否多于剩余q？若是则直接返回该字符串。

否则减掉当前位置的数量后，考察下一位是0的字符串个数，多于剩余q？若是则下一位是0，若不是则下一位是1，减去下一位是0的个数。遍历到退出即可。